<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Job Tracker | Secure Portal</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-[#0a192f] text-[#ccd6f6]">

<div class="max-w-5xl mx-auto p-8 space-y-10">

  <!-- Header -->
  <div>
    <h1 class="text-2xl font-semibold text-[#e6f1ff]">Job Application Tracker</h1>
    <p class="text-sm text-[#a8b2d1] mt-1">
      Track applications, interviews, and follow-ups.
    </p>
  </div>

  <!-- Form -->
  <form id="jobForm" class="space-y-4 max-w-xl">

    <input
      id="company"
      type="text"
      placeholder="Company"
      class="w-full p-2 rounded bg-[#112240]"
      required
    />

    <input
      id="title"
      type="text"
      placeholder="Job Title"
      class="w-full p-2 rounded bg-[#112240]"
      required
    />

    <select id="status" class="w-full p-2 rounded bg-[#112240]">
      <option value="Applied">Applied</option>
      <option value="Interviewing">Interviewing</option>
      <option value="Rejected">Rejected</option>
      <option value="Offer">Offer</option>
    </select>

    <textarea
      id="notes"
      placeholder="Notes"
      class="w-full p-2 rounded bg-[#112240]"
    ></textarea>

    <button
      type="submit"
      class="bg-teal-400 text-black px-4 py-2 rounded"
    >
      Save Job
    </button>

    <p id="statusMsg" class="text-sm"></p>
  </form>

</div>

<!-- ✅ SUPABASE + LOGIC -->
<script type="module">
  import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/+esm";

  const supabaseUrl = "https://lveuvtszgjorqtqaveny.supabase.co";
  const supabaseKey = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imx2ZXV2dHN6Z2pvcnF0cWF2ZW55Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU5OTc4NjYsImV4cCI6MjA4MTU3Mzg2Nn0.uAln7ZzQ2KpKcGn9gLcoFnC61gBeRkLIT6jpEfRrj7I"; // keep anon key here
  const supabase = createClient(supabaseUrl, supabaseKey);

  document
    .getElementById("jobForm")
    .addEventListener("submit", async (e) => {
      e.preventDefault();

      const msg = document.getElementById("statusMsg");
      msg.textContent = "Saving...";

      const company = document.getElementById("company").value.trim();
      const title = document.getElementById("title").value.trim();
      const status = document.getElementById("status").value;
      const notes = document.getElementById("notes").value.trim();

      const { error } = await supabase
        .from("job_tracker")
        .insert([
          {
            company,
            title,
            status,
            notes,
          },
        ]);

      if (error) {
        console.error("Supabase error:", error);
        msg.textContent = error.message;
        return;
      }

      msg.textContent = "✅ Job saved successfully";
      document.getElementById("jobForm").reset();
    });
</script>

</body>
</html>
