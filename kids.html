<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LearnQuest Academy - Learn, Play, Lead!</title>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600;700&family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-purple: #8B5CF6;
            --primary-pink: #EC4899;
            --primary-orange: #F97316;
            --primary-blue: #3B82F6;
            --primary-green: #10B981;
            --primary-yellow: #FCD34D;
            --bg-cream: #FFF8F0;
            --bg-white: #FFFFFF;
            --text-dark: #1F2937;
            --text-medium: #6B7280;
            --shadow: 0 4px 6px rgba(0,0,0,0.1);
            --shadow-lg: 0 10px 25px rgba(0,0,0,0.15);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #FFF8F0 0%, #FFE4E1 100%);
            color: var(--text-dark);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .stars {
            position: fixed;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
        }

        .star {
            position: absolute;
            width: 20px;
            height: 20px;
            background: var(--primary-yellow);
            clip-path: polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%);
            opacity: 0.3;
            animation: twinkle 3s ease-in-out infinite;
        }

        @keyframes twinkle {
            0%, 100% { opacity: 0.3; transform: scale(1) rotate(0deg); }
            50% { opacity: 0.8; transform: scale(1.2) rotate(180deg); }
        }

        /* Login Screen */
        .login-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .login-box {
            background: white;
            border-radius: 30px;
            padding: 50px;
            max-width: 450px;
            width: 90%;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            animation: slideUp 0.6s ease-out;
        }

        @keyframes slideUp {
            from { transform: translateY(100px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .login-logo {
            text-align: center;
            font-family: 'Fredoka', sans-serif;
            font-size: 3rem;
            margin-bottom: 10px;
            background: linear-gradient(135deg, var(--primary-purple) 0%, var(--primary-pink) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .login-subtitle {
            text-align: center;
            color: var(--text-medium);
            margin-bottom: 30px;
            font-size: 1.1rem;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-dark);
        }

        .form-input {
            width: 100%;
            padding: 15px;
            border: 2px solid #E5E7EB;
            border-radius: 12px;
            font-size: 1rem;
            font-family: 'Poppins', sans-serif;
            transition: all 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary-purple);
            box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.1);
        }

        .avatar-selection {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin-top: 10px;
        }

        .avatar-option {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            cursor: pointer;
            border: 3px solid transparent;
            transition: all 0.3s ease;
            background: #F3F4F6;
        }

        .avatar-option:hover {
            transform: scale(1.1);
            background: #E5E7EB;
        }

        .avatar-option.selected {
            border-color: var(--primary-purple);
            background: #EDE9FE;
            transform: scale(1.15);
        }

        .btn-primary {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, var(--primary-purple) 0%, var(--primary-pink) 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-family: 'Fredoka', sans-serif;
            font-size: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 10px;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(139, 92, 246, 0.3);
        }

        .age-selector {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 10px;
        }

        .age-btn {
            flex: 1;
            min-width: 60px;
            padding: 10px;
            border: 2px solid #E5E7EB;
            border-radius: 10px;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .age-btn:hover {
            border-color: var(--primary-purple);
            background: #F3F4F6;
        }

        .age-btn.selected {
            border-color: var(--primary-purple);
            background: var(--primary-purple);
            color: white;
        }

        /* Main App */
        .app-container {
            display: none;
            position: relative;
            z-index: 1;
        }

        .app-container.active {
            display: block;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .top-nav {
            background: white;
            border-radius: 20px;
            padding: 15px 30px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: var(--shadow);
        }

        .logo {
            font-family: 'Fredoka', sans-serif;
            font-size: 1.5rem;
            background: linear-gradient(135deg, var(--primary-purple) 0%, var(--primary-pink) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .user-menu {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-purple) 0%, var(--primary-pink) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 3px solid white;
            box-shadow: var(--shadow);
        }

        .user-avatar:hover {
            transform: scale(1.1);
        }

        .logout-btn {
            padding: 8px 20px;
            background: #EF4444;
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .logout-btn:hover {
            background: #DC2626;
            transform: translateY(-2px);
        }

        header {
            background: linear-gradient(135deg, var(--primary-purple) 0%, var(--primary-pink) 100%);
            border-radius: 30px;
            padding: 40px;
            box-shadow: var(--shadow-lg);
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -10%;
            width: 400px;
            height: 400px;
            background: rgba(255,255,255,0.1);
            border-radius: 50%;
        }

        .header-content {
            position: relative;
            z-index: 1;
        }

        h1 {
            font-family: 'Fredoka', sans-serif;
            font-size: 2.5rem;
            color: white;
            text-align: center;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.2);
            margin-bottom: 10px;
        }

        .welcome-message {
            text-align: center;
            color: white;
            font-size: 1.5rem;
            font-weight: 600;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            border-radius: 20px;
            padding: 25px;
            box-shadow: var(--shadow);
            text-align: center;
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        .stat-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .stat-value {
            font-family: 'Fredoka', sans-serif;
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary-purple) 0%, var(--primary-pink) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 5px;
        }

        .stat-label {
            color: var(--text-medium);
            font-weight: 600;
        }

        .learning-areas {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .learning-card {
            background: white;
            border-radius: 25px;
            padding: 30px;
            box-shadow: var(--shadow);
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
            overflow: hidden;
        }

        .learning-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            transition: height 0.3s ease;
        }

        .learning-card:hover::before {
            height: 100%;
            opacity: 0.1;
        }

        .learning-card.math::before { background: var(--primary-blue); }
        .learning-card.reading::before { background: var(--primary-green); }
        .learning-card.spelling::before { background: var(--primary-orange); }
        .learning-card.games::before { background: var(--primary-pink); }
        .learning-card.ai::before { background: var(--primary-purple); }

        .learning-card:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
        }

        .card-icon {
            font-size: 3.5rem;
            margin-bottom: 15px;
            display: inline-block;
            animation: bounce 2s ease-in-out infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .card-title {
            font-family: 'Fredoka', sans-serif;
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 10px;
            position: relative;
            z-index: 1;
        }

        .card-description {
            color: var(--text-medium);
            margin-bottom: 20px;
            line-height: 1.6;
            position: relative;
            z-index: 1;
        }

        .progress-container {
            position: relative;
            z-index: 1;
        }

        .progress-bar {
            background: #E5E7EB;
            height: 10px;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 10px;
        }

        .progress-fill {
            height: 100%;
            border-radius: 10px;
            transition: width 0.5s ease;
            position: relative;
            overflow: hidden;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            bottom: 0;
            right: 0;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255,255,255,0.3), 
                transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .progress-fill.math { background: linear-gradient(90deg, var(--primary-blue) 0%, #60A5FA 100%); }
        .progress-fill.reading { background: linear-gradient(90deg, var(--primary-green) 0%, #34D399 100%); }
        .progress-fill.spelling { background: linear-gradient(90deg, var(--primary-orange) 0%, #FB923C 100%); }
        .progress-fill.games { background: linear-gradient(90deg, var(--primary-pink) 0%, #F472B6 100%); }
        .progress-fill.ai { background: linear-gradient(90deg, var(--primary-purple) 0%, #A78BFA 100%); }

        .progress-text {
            display: flex;
            justify-content: space-between;
            font-size: 0.9rem;
            color: var(--text-medium);
            font-weight: 600;
        }

        .leaderboard {
            background: white;
            border-radius: 25px;
            padding: 35px;
            box-shadow: var(--shadow);
        }

        .leaderboard-title {
            font-family: 'Fredoka', sans-serif;
            font-size: 2.2rem;
            font-weight: 700;
            margin-bottom: 25px;
            text-align: center;
            background: linear-gradient(135deg, var(--primary-purple) 0%, var(--primary-pink) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .leaderboard-list {
            list-style: none;
        }

        .leaderboard-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 18px 20px;
            margin-bottom: 12px;
            border-radius: 15px;
            background: #F9FAFB;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .leaderboard-item::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            width: 4px;
            background: var(--primary-purple);
            transform: scaleY(0);
            transition: transform 0.3s ease;
        }

        .leaderboard-item:hover {
            transform: translateX(10px);
            box-shadow: var(--shadow);
        }

        .leaderboard-item:hover::before {
            transform: scaleY(1);
        }

        .leaderboard-item.current-user {
            background: linear-gradient(135deg, #FEF3C7 0%, #FDE68A 100%);
            border: 2px solid var(--primary-yellow);
        }

        .leaderboard-item.top-1 {
            background: linear-gradient(135deg, #FCD34D 0%, #F59E0B 100%);
            color: white;
        }

        .leaderboard-item.top-2 {
            background: linear-gradient(135deg, #E5E7EB 0%, #D1D5DB 100%);
        }

        .leaderboard-item.top-3 {
            background: linear-gradient(135deg, #FBBF24 0%, #F59E0B 100%);
        }

        .rank {
            font-family: 'Fredoka', sans-serif;
            font-size: 1.5rem;
            font-weight: 700;
            width: 50px;
            text-align: center;
        }

        .player-info {
            flex: 1;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .player-avatar {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            border: 2px solid rgba(0,0,0,0.1);
        }

        .player-name {
            font-weight: 600;
            font-size: 1.1rem;
        }

        .player-points {
            font-family: 'Fredoka', sans-serif;
            font-size: 1.4rem;
            font-weight: 700;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            animation: fadeIn 0.3s ease;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 30px;
            padding: 40px;
            max-width: 700px;
            width: 90%;
            max-height: 85vh;
            overflow-y: auto;
            box-shadow: var(--shadow-lg);
            animation: modalSlide 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        @keyframes modalSlide {
            from { transform: scale(0.7) translateY(-50px); opacity: 0; }
            to { transform: scale(1) translateY(0); opacity: 1; }
        }

        .modal-header {
            font-family: 'Fredoka', sans-serif;
            font-size: 2.2rem;
            font-weight: 700;
            margin-bottom: 25px;
            text-align: center;
            background: linear-gradient(135deg, var(--primary-purple) 0%, var(--primary-pink) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .close-btn {
            background: linear-gradient(135deg, var(--primary-pink) 0%, var(--primary-purple) 100%);
            color: white;
            border: none;
            border-radius: 15px;
            padding: 12px 35px;
            font-family: 'Fredoka', sans-serif;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            margin-top: 20px;
            transition: all 0.3s ease;
            display: block;
            margin-left: auto;
            margin-right: auto;
        }

        .close-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(236, 72, 153, 0.3);
        }

        .quiz-question {
            background: linear-gradient(135deg, #F9FAFB 0%, #F3F4F6 100%);
            padding: 25px;
            border-radius: 20px;
            margin-bottom: 20px;
            border-left: 5px solid var(--primary-purple);
        }

        .question-number {
            color: var(--primary-purple);
            font-weight: 700;
            margin-bottom: 10px;
        }

        .quiz-options {
            display: grid;
            gap: 12px;
            margin-top: 20px;
        }

        .quiz-option {
            background: white;
            border: 3px solid #E5E7EB;
            border-radius: 15px;
            padding: 18px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.05rem;
            font-weight: 500;
            position: relative;
            overflow: hidden;
        }

        .quiz-option::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            width: 0;
            background: linear-gradient(90deg, var(--primary-purple), var(--primary-pink));
            transition: width 0.3s ease;
            z-index: 0;
        }

        .quiz-option span {
            position: relative;
            z-index: 1;
        }

        .quiz-option:hover {
            border-color: var(--primary-purple);
            transform: translateX(8px);
        }

        .quiz-option.selected {
            border-color: var(--primary-purple);
            background: linear-gradient(135deg, var(--primary-purple) 0%, var(--primary-pink) 100%);
            color: white;
        }

        .quiz-option.selected::before {
            width: 100%;
        }

        .submit-quiz {
            background: linear-gradient(135deg, var(--primary-green) 0%, #34D399 100%);
            color: white;
            border: none;
            border-radius: 15px;
            padding: 18px 45px;
            font-family: 'Fredoka', sans-serif;
            font-size: 1.3rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: block;
            margin: 25px auto;
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
        }

        .submit-quiz:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(16, 185, 129, 0.4);
        }

        .submit-quiz:active {
            transform: translateY(-1px);
        }

        .celebration {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 6rem;
            opacity: 0;
            pointer-events: none;
            z-index: 3000;
        }

        .celebration.show {
            animation: celebrate 1.5s ease-out;
        }

        @keyframes celebrate {
            0% { opacity: 0; transform: translate(-50%, -50%) scale(0) rotate(0deg); }
            50% { opacity: 1; transform: translate(-50%, -50%) scale(1.5) rotate(180deg); }
            100% { opacity: 0; transform: translate(-50%, -50%) scale(1) rotate(360deg); }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .login-box { padding: 30px; }
            h1 { font-size: 2rem; }
            .stats-grid { grid-template-columns: repeat(2, 1fr); }
            .learning-areas { grid-template-columns: 1fr; }
            .user-menu { gap: 10px; }
            .avatar-selection { grid-template-columns: repeat(3, 1fr); }
        }
    </style>
</head>
<body>
    <div class="stars" id="stars"></div>
    <div class="celebration" id="celebration">üéâ</div>

    <!-- Login Screen -->
    <div class="login-container" id="loginScreen">
        <div class="login-box">
            <div class="login-logo">üöÄ LearnQuest</div>
            <p class="login-subtitle">Start Your Learning Adventure!</p>
            
            <div class="form-group">
                <label class="form-label">Your Name</label>
                <input type="text" class="form-input" id="userName" placeholder="Enter your name" maxlength="20">
            </div>

            <div class="form-group">
                <label class="form-label">How old are you?</label>
                <div class="age-selector" id="ageSelector">
                    <button class="age-btn" data-age="6">6</button>
                    <button class="age-btn" data-age="7">7</button>
                    <button class="age-btn" data-age="8">8</button>
                    <button class="age-btn" data-age="9">9</button>
                    <button class="age-btn" data-age="10">10</button>
                    <button class="age-btn" data-age="11">11</button>
                    <button class="age-btn" data-age="12">12</button>
                    <button class="age-btn" data-age="13">13</button>
                    <button class="age-btn" data-age="14">14</button>
                    <button class="age-btn" data-age="15">15</button>
                </div>
            </div>

            <div class="form-group">
                <label class="form-label">Choose Your Avatar</label>
                <div class="avatar-selection" id="avatarSelector">
                    <div class="avatar-option" data-avatar="ü¶Å">ü¶Å</div>
                    <div class="avatar-option" data-avatar="üêº">üêº</div>
                    <div class="avatar-option" data-avatar="ü¶ä">ü¶ä</div>
                    <div class="avatar-option" data-avatar="üê®">üê®</div>
                    <div class="avatar-option" data-avatar="ü¶â">ü¶â</div>
                    <div class="avatar-option" data-avatar="üê∏">üê∏</div>
                    <div class="avatar-option" data-avatar="ü¶Ñ">ü¶Ñ</div>
                    <div class="avatar-option" data-avatar="üê≤">üê≤</div>
                    <div class="avatar-option" data-avatar="üöÄ">üöÄ</div>
                    <div class="avatar-option" data-avatar="‚≠ê">‚≠ê</div>
                    <div class="avatar-option" data-avatar="üåà">üåà</div>
                    <div class="avatar-option" data-avatar="üé®">üé®</div>
                </div>
            </div>

            <button class="btn-primary" onclick="login()">Start Learning! üéì</button>
        </div>
    </div>

    <!-- Main App -->
    <div class="app-container" id="appContainer">
        <div class="container">
            <div class="top-nav">
                <div class="logo">üöÄ LearnQuest Academy</div>
                <div class="user-menu">
                    <span id="navUserName" style="font-weight: 600;"></span>
                    <div class="user-avatar" id="navUserAvatar" onclick="showProfile()"></div>
                    <button class="logout-btn" onclick="logout()">Logout</button>
                </div>
            </div>

            <header>
                <div class="header-content">
                    <h1>üåü Welcome Back, <span id="headerUserName"></span>!</h1>
                    <p class="welcome-message">Ready to learn something amazing today?</p>
                </div>
            </header>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">üèÜ</div>
                    <div class="stat-value" id="userLevel">1</div>
                    <div class="stat-label">Level</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">‚≠ê</div>
                    <div class="stat-value" id="userPoints">0</div>
                    <div class="stat-label">Total Points</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">üéØ</div>
                    <div class="stat-value" id="userRank">-</div>
                    <div class="stat-label">Rank</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">üî•</div>
                    <div class="stat-value" id="userStreak">0</div>
                    <div class="stat-label">Day Streak</div>
                </div>
            </div>

            <div class="learning-areas">
                <div class="learning-card math" onclick="openActivity('math')">
                    <div class="card-icon">üßÆ</div>
                    <h3 class="card-title">Math Master</h3>
                    <p class="card-description">Solve puzzles, master numbers, and become a calculation champion!</p>
                    <div class="progress-container">
                        <div class="progress-bar">
                            <div class="progress-fill math" id="progressMath" style="width: 0%;"></div>
                        </div>
                        <div class="progress-text">
                            <span id="mathCompleted">0</span>
                            <span id="mathPercent">0%</span>
                        </div>
                    </div>
                </div>

                <div class="learning-card reading" onclick="openActivity('reading')">
                    <div class="card-icon">üìö</div>
                    <h3 class="card-title">Reading Adventure</h3>
                    <p class="card-description">Explore amazing stories and unlock new worlds through reading!</p>
                    <div class="progress-container">
                        <div class="progress-bar">
                            <div class="progress-fill reading" id="progressReading" style="width: 0%;"></div>
                        </div>
                        <div class="progress-text">
                            <span id="readingCompleted">0</span>
                            <span id="readingPercent">0%</span>
                        </div>
                    </div>
                </div>

                <div class="learning-card spelling" onclick="openActivity('spelling')">
                    <div class="card-icon">‚úèÔ∏è</div>
                    <h3 class="card-title">Spelling Bee</h3>
                    <p class="card-description">Challenge yourself with words and become a spelling superstar!</p>
                    <div class="progress-container">
                        <div class="progress-bar">
                            <div class="progress-fill spelling" id="progressSpelling" style="width: 0%;"></div>
                        </div>
                        <div class="progress-text">
                            <span id="spellingCompleted">0</span>
                            <span id="spellingPercent">0%</span>
                        </div>
                    </div>
                </div>

                <div class="learning-card games" onclick="openActivity('games')">
                    <div class="card-icon">üéÆ</div>
                    <h3 class="card-title">Game Builder</h3>
                    <p class="card-description">Create your own games and share them with friends!</p>
                    <div class="progress-container">
                        <div class="progress-bar">
                            <div class="progress-fill games" id="progressGames" style="width: 0%;"></div>
                        </div>
                        <div class="progress-text">
                            <span id="gamesCompleted">0</span>
                            <span id="gamesPercent">0%</span>
                        </div>
                    </div>
                </div>

                <div class="learning-card ai" onclick="openActivity('ai')">
                    <div class="card-icon">ü§ñ</div>
                    <h3 class="card-title">AI Explorer</h3>
                    <p class="card-description">Learn how AI works and build your own smart programs!</p>
                    <div class="progress-container">
                        <div class="progress-bar">
                            <div class="progress-fill ai" id="progressAI" style="width: 0%;"></div>
                        </div>
                        <div class="progress-text">
                            <span id="aiCompleted">0</span>
                            <span id="aiPercent">0%</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="leaderboard">
                <h2 class="leaderboard-title">üèÜ Top Learners</h2>
                <ul class="leaderboard-list" id="leaderboardList"></ul>
            </div>
        </div>
    </div>

    <!-- Activity Modal -->
    <div class="modal" id="activityModal">
        <div class="modal-content">
            <h2 class="modal-header" id="modalTitle">Activity</h2>
            <div id="modalBody"></div>
            <button class="close-btn" onclick="closeModal()">Close</button>
        </div>
    </div>

    <script>
        // Global state
        let currentUser = null;
        let selectedAge = null;
        let selectedAvatar = null;
        let allUsers = [];

        // Create stars
        function createStars() {
            const starsContainer = document.getElementById('stars');
            for (let i = 0; i < 40; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.animationDelay = Math.random() * 3 + 's';
                starsContainer.appendChild(star);
            }
        }
        createStars();

        // Age selection
        document.getElementById('ageSelector').addEventListener('click', (e) => {
            if (e.target.classList.contains('age-btn')) {
                document.querySelectorAll('.age-btn').forEach(btn => btn.classList.remove('selected'));
                e.target.classList.add('selected');
                selectedAge = e.target.dataset.age;
            }
        });

        // Avatar selection
        document.getElementById('avatarSelector').addEventListener('click', (e) => {
            if (e.target.classList.contains('avatar-option')) {
                document.querySelectorAll('.avatar-option').forEach(opt => opt.classList.remove('selected'));
                e.target.classList.add('selected');
                selectedAvatar = e.target.dataset.avatar;
            }
        });

        // Login function
        async function login() {
            const userName = document.getElementById('userName').value.trim();
            
            if (!userName) {
                alert('Please enter your name! üòä');
                return;
            }
            
            if (!selectedAge) {
                alert('Please select your age! üéÇ');
                return;
            }
            
            if (!selectedAvatar) {
                alert('Please choose an avatar! üé®');
                return;
            }

            // Create user object
            currentUser = {
                name: userName,
                age: selectedAge,
                avatar: selectedAvatar,
                level: 1,
                points: 0,
                streak: 0,
                progress: {
                    math: 0,
                    reading: 0,
                    spelling: 0,
                    games: 0,
                    ai: 0
                },
                joinedDate: new Date().toISOString()
            };

            // Save to storage
            try {
                await window.storage.set(`user:${userName}`, JSON.stringify(currentUser), true);
                localStorage.setItem('currentUser', userName);
                showApp();
            } catch (error) {
                console.error('Error saving user:', error);
                // Fallback to localStorage only
                localStorage.setItem('currentUser', userName);
                localStorage.setItem(`user:${userName}`, JSON.stringify(currentUser));
                showApp();
            }
        }

        // Load user
        async function loadUser() {
            const userName = localStorage.getItem('currentUser');
            if (!userName) return false;

            try {
                const result = await window.storage.get(`user:${userName}`, true);
                if (result && result.value) {
                    currentUser = JSON.parse(result.value);
                    return true;
                }
            } catch (error) {
                console.error('Error loading user:', error);
                // Fallback to localStorage
                const userData = localStorage.getItem(`user:${userName}`);
                if (userData) {
                    currentUser = JSON.parse(userData);
                    return true;
                }
            }
            return false;
        }

        // Show app
        function showApp() {
            document.getElementById('loginScreen').style.display = 'none';
            document.getElementById('appContainer').classList.add('active');
            
            // Update UI with user data
            document.getElementById('headerUserName').textContent = currentUser.name;
            document.getElementById('navUserName').textContent = currentUser.name;
            document.getElementById('navUserAvatar').textContent = currentUser.avatar;
            document.getElementById('userLevel').textContent = currentUser.level;
            document.getElementById('userPoints').textContent = currentUser.points.toLocaleString();
            document.getElementById('userStreak').textContent = currentUser.streak;

            // Update progress bars
            updateProgressBars();
            
            // Load leaderboard
            loadLeaderboard();
        }

        // Update progress bars
        function updateProgressBars() {
            const subjects = ['math', 'reading', 'spelling', 'games', 'ai'];
            subjects.forEach(subject => {
                const progress = currentUser.progress[subject] || 0;
                const percent = Math.round(progress);
                document.getElementById(`progress${subject.charAt(0).toUpperCase() + subject.slice(1)}`).style.width = percent + '%';
                document.getElementById(`${subject}Completed`).textContent = `${progress} activities`;
                document.getElementById(`${subject}Percent`).textContent = percent + '%';
            });
        }

        // Save user data
        async function saveUserData() {
            try {
                await window.storage.set(`user:${currentUser.name}`, JSON.stringify(currentUser), true);
                localStorage.setItem(`user:${currentUser.name}`, JSON.stringify(currentUser));
            } catch (error) {
                console.error('Error saving user data:', error);
                localStorage.setItem(`user:${currentUser.name}`, JSON.stringify(currentUser));
            }
        }

        // Load leaderboard
        async function loadLeaderboard() {
            try {
                const result = await window.storage.list('user:', true);
                if (result && result.keys) {
                    const userPromises = result.keys.map(async key => {
                        try {
                            const userData = await window.storage.get(key, true);
                            return userData && userData.value ? JSON.parse(userData.value) : null;
                        } catch {
                            return null;
                        }
                    });
                    
                    allUsers = (await Promise.all(userPromises)).filter(u => u !== null);
                }
            } catch (error) {
                console.error('Error loading leaderboard:', error);
                allUsers = [];
            }

            // Add current user if not in list
            if (!allUsers.find(u => u.name === currentUser.name)) {
                allUsers.push(currentUser);
            }

            // Sort by points
            allUsers.sort((a, b) => b.points - a.points);

            // Update rank
            const userRank = allUsers.findIndex(u => u.name === currentUser.name) + 1;
            document.getElementById('userRank').textContent = userRank;

            // Render leaderboard
            const leaderboardList = document.getElementById('leaderboardList');
            leaderboardList.innerHTML = '';

            allUsers.slice(0, 10).forEach((user, index) => {
                const li = document.createElement('li');
                li.className = 'leaderboard-item';
                
                if (index === 0) li.classList.add('top-1');
                else if (index === 1) li.classList.add('top-2');
                else if (index === 2) li.classList.add('top-3');
                
                if (user.name === currentUser.name) {
                    li.classList.add('current-user');
                }

                const rankEmoji = index === 0 ? 'ü•á' : index === 1 ? 'ü•à' : index === 2 ? 'ü•â' : (index + 1);

                li.innerHTML = `
                    <span class="rank">${rankEmoji}</span>
                    <div class="player-info">
                        <div class="player-avatar">${user.avatar}</div>
                        <span class="player-name">${user.name}</span>
                    </div>
                    <span class="player-points">${user.points.toLocaleString()} pts</span>
                `;
                
                leaderboardList.appendChild(li);
            });
        }

        // Logout
        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                localStorage.removeItem('currentUser');
                location.reload();
            }
        }

        // Show profile
        function showProfile() {
            alert(`üë§ ${currentUser.name}\nüéÇ Age: ${currentUser.age}\nüèÜ Level: ${currentUser.level}\n‚≠ê Points: ${currentUser.points}\nüî• Streak: ${currentUser.streak} days`);
        }

        // Activity system (quiz content)
        const activities = {
            math: {
                title: 'üßÆ Math Master Quiz',
                quizzes: [
                    {
                        question: 'What is 12 √ó 9?',
                        options: ['98', '108', '118', '128'],
                        correct: 1
                    },
                    {
                        question: 'If you have 50 cookies and share them equally among 5 friends, how many does each friend get?',
                        options: ['8', '9', '10', '11'],
                        correct: 2
                    },
                    {
                        question: 'What is 144 √∑ 12?',
                        options: ['10', '11', '12', '13'],
                        correct: 2
                    },
                    {
                        question: 'What is 15 + 28 + 37?',
                        options: ['70', '75', '80', '85'],
                        correct: 2
                    },
                    {
                        question: 'A rectangle has a length of 8cm and width of 5cm. What is its area?',
                        options: ['30 cm¬≤', '35 cm¬≤', '40 cm¬≤', '45 cm¬≤'],
                        correct: 2
                    }
                ]
            },
            reading: {
                title: 'üìö Reading Comprehension',
                quizzes: [
                    {
                        question: 'Read this passage: "Luna was excited about her first day at the Space Academy. She had dreamed of becoming an astronaut since she was five years old. As she put on her silver training suit, she couldn\'t stop smiling." What is Luna\'s dream?',
                        options: ['To be a teacher', 'To become an astronaut', 'To be a scientist', 'To be a pilot'],
                        correct: 1
                    },
                    {
                        question: 'In the story, how old was Luna when she started dreaming about space?',
                        options: ['Three years old', 'Four years old', 'Five years old', 'Six years old'],
                        correct: 2
                    }
                ]
            },
            spelling: {
                title: '‚úèÔ∏è Spelling Challenge',
                quizzes: [
                    {
                        question: 'Which is the correct spelling?',
                        options: ['DEFINATELY', 'DEFINITELY', 'DEFINATLY', 'DEFINENTLY'],
                        correct: 1
                    },
                    {
                        question: 'How do you spell "very unusual or remarkable"?',
                        options: ['EXTRAORDINARY', 'EXTRAORDINERY', 'EXTRAORDIANRY', 'EXTRODINARY'],
                        correct: 0
                    },
                    {
                        question: 'Which spelling is correct for "aware of what is happening"?',
                        options: ['CONSCIOUS', 'CONCIOUS', 'CONSIOUS', 'CONSCOUS'],
                        correct: 0
                    }
                ]
            },
            games: {
                title: 'üéÆ Game Builder Quiz',
                quizzes: [
                    {
                        question: 'In game design, what does "FPS" stand for?',
                        options: ['Fast Player Speed', 'Frames Per Second', 'First Person Shooter', 'Fun Play Style'],
                        correct: 1
                    },
                    {
                        question: 'What is a "sprite" in game development?',
                        options: ['A type of drink', 'A 2D image or animation', 'A game level', 'A player character'],
                        correct: 1
                    }
                ]
            },
            ai: {
                title: 'ü§ñ AI Explorer Quiz',
                quizzes: [
                    {
                        question: 'What does AI stand for?',
                        options: ['Automatic Intelligence', 'Artificial Intelligence', 'Advanced Intelligence', 'Automated Information'],
                        correct: 1
                    },
                    {
                        question: 'Which of these is an example of AI?',
                        options: ['A calculator', 'A voice assistant like Siri', 'A regular camera', 'A keyboard'],
                        correct: 1
                    },
                    {
                        question: 'How does AI learn?',
                        options: ['By reading books', 'From patterns in data', 'By watching videos', 'It doesn\'t learn'],
                        correct: 1
                    }
                ]
            }
        };

        // Open activity
        function openActivity(type) {
            const modal = document.getElementById('activityModal');
            const modalTitle = document.getElementById('modalTitle');
            const modalBody = document.getElementById('modalBody');
            
            const activity = activities[type];
            modalTitle.textContent = activity.title;
            
            let quizHTML = '';
            activity.quizzes.forEach((q, index) => {
                quizHTML += `
                    <div class="quiz-question" data-correct="${q.correct}" data-type="${type}">
                        <div class="question-number">Question ${index + 1} of ${activity.quizzes.length}</div>
                        <h4 style="margin-bottom: 15px; font-size: 1.1rem; line-height: 1.6;">${q.question}</h4>
                        <div class="quiz-options">
                            ${q.options.map((opt, i) => `
                                <div class="quiz-option" data-index="${i}" onclick="selectQuizOption(this)">
                                    <span>${opt}</span>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            });
            
            quizHTML += `<button class="submit-quiz" onclick="submitQuiz('${type}')">Submit Quiz üöÄ</button>`;
            modalBody.innerHTML = quizHTML;
            modal.classList.add('active');
        }

        // Close modal
        function closeModal() {
            document.getElementById('activityModal').classList.remove('active');
        }

        // Select quiz option
        function selectQuizOption(element) {
            const parent = element.closest('.quiz-options');
            parent.querySelectorAll('.quiz-option').forEach(opt => opt.classList.remove('selected'));
            element.classList.add('selected');
        }

        // Submit quiz
        async function submitQuiz(type) {
            const questions = document.querySelectorAll('.quiz-question');
            let correct = 0;
            let total = questions.length;
            
            questions.forEach(q => {
                const selected = q.querySelector('.quiz-option.selected');
                if (selected && parseInt(selected.dataset.index) === parseInt(q.dataset.correct)) {
                    correct++;
                }
            });
            
            const pointsEarned = correct * 100;
            const percentage = Math.round((correct / total) * 100);
            
            // Update user stats
            currentUser.points += pointsEarned;
            currentUser.progress[type] = Math.min(100, (currentUser.progress[type] || 0) + (correct * 5));
            
            // Check for level up
            const newLevel = Math.floor(currentUser.points / 500) + 1;
            const leveledUp = newLevel > currentUser.level;
            currentUser.level = newLevel;
            
            // Save data
            await saveUserData();
            
            // Show celebration
            showCelebration();
            
            // Update UI
            document.getElementById('userLevel').textContent = currentUser.level;
            document.getElementById('userPoints').textContent = currentUser.points.toLocaleString();
            updateProgressBars();
            loadLeaderboard();
            
            // Show results
            let message = `üéâ Amazing Work!\n\n`;
            message += `‚úÖ Correct: ${correct}/${total}\n`;
            message += `üìä Score: ${percentage}%\n`;
            message += `‚≠ê Points Earned: +${pointsEarned}\n`;
            message += `üèÜ Total Points: ${currentUser.points}`;
            
            if (leveledUp) {
                message += `\n\nüéä LEVEL UP! You're now Level ${currentUser.level}!`;
            }
            
            alert(message);
            closeModal();
        }

        // Show celebration
        function showCelebration() {
            const celebration = document.getElementById('celebration');
            const emojis = ['üéâ', 'üåü', '‚≠ê', 'üèÜ', 'üéä', '‚ú®', 'üöÄ'];
            celebration.textContent = emojis[Math.floor(Math.random() * emojis.length)];
            celebration.classList.add('show');
            setTimeout(() => celebration.classList.remove('show'), 1500);
        }

        // Initialize app
        async function init() {
            const hasUser = await loadUser();
            if (hasUser) {
                showApp();
            }
        }

        // Start the app
        init();
    </script>
</body>
</html>