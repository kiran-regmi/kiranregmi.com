<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LearnQuest Academy - Learn, Play, Lead!</title>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600;700&family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-purple: #8B5CF6;
            --primary-pink: #EC4899;
            --primary-orange: #F97316;
            --primary-blue: #3B82F6;
            --primary-green: #10B981;
            --primary-yellow: #FCD34D;
            --primary-red: #EF4444;
            --bg-cream: #FFF8F0;
            --bg-white: #FFFFFF;
            --text-dark: #1F2937;
            --text-medium: #6B7280;
            --shadow: 0 4px 6px rgba(0,0,0,0.1);
            --shadow-lg: 0 10px 25px rgba(0,0,0,0.15);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #FFF8F0 0%, #FFE4E1 100%);
            color: var(--text-dark);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .stars {
            position: fixed;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
        }

        .star {
            position: absolute;
            width: 20px;
            height: 20px;
            background: var(--primary-yellow);
            clip-path: polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%);
            opacity: 0.3;
            animation: twinkle 3s ease-in-out infinite;
        }

        @keyframes twinkle {
            0%, 100% { opacity: 0.3; transform: scale(1) rotate(0deg); }
            50% { opacity: 0.8; transform: scale(1.2) rotate(180deg); }
        }

        /* Login Screen */
        .login-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .login-box {
            background: white;
            border-radius: 30px;
            padding: 50px;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            animation: slideUp 0.6s ease-out;
        }

        @keyframes slideUp {
            from { transform: translateY(100px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .login-logo {
            text-align: center;
            font-family: 'Fredoka', sans-serif;
            font-size: 3rem;
            margin-bottom: 10px;
            background: linear-gradient(135deg, var(--primary-purple) 0%, var(--primary-pink) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .login-subtitle {
            text-align: center;
            color: var(--text-medium);
            margin-bottom: 30px;
            font-size: 1.1rem;
        }

        .user-type-selector {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 30px;
        }

        .user-type-btn {
            padding: 20px;
            border: 3px solid #E5E7EB;
            border-radius: 15px;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-weight: 600;
            font-size: 1.1rem;
        }

        .user-type-btn:hover {
            border-color: var(--primary-purple);
            background: #F3F4F6;
        }

        .user-type-btn.selected {
            border-color: var(--primary-purple);
            background: linear-gradient(135deg, var(--primary-purple) 0%, var(--primary-pink) 100%);
            color: white;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-dark);
        }

        .form-input {
            width: 100%;
            padding: 15px;
            border: 2px solid #E5E7EB;
            border-radius: 12px;
            font-size: 1rem;
            font-family: 'Poppins', sans-serif;
            transition: all 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary-purple);
            box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.1);
        }

        .avatar-selection {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin-top: 10px;
        }

        .avatar-option {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            cursor: pointer;
            border: 3px solid transparent;
            transition: all 0.3s ease;
            background: #F3F4F6;
        }

        .avatar-option:hover {
            transform: scale(1.1);
            background: #E5E7EB;
        }

        .avatar-option.selected {
            border-color: var(--primary-purple);
            background: #EDE9FE;
            transform: scale(1.15);
        }

        .btn-primary {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, var(--primary-purple) 0%, var(--primary-pink) 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-family: 'Fredoka', sans-serif;
            font-size: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 10px;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(139, 92, 246, 0.3);
        }

        .age-selector {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 10px;
        }

        .age-btn {
            flex: 1;
            min-width: 60px;
            padding: 10px;
            border: 2px solid #E5E7EB;
            border-radius: 10px;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .age-btn:hover {
            border-color: var(--primary-purple);
            background: #F3F4F6;
        }

        .age-btn.selected {
            border-color: var(--primary-purple);
            background: var(--primary-purple);
            color: white;
        }

        /* Main App */
        .app-container {
            display: none;
            position: relative;
            z-index: 1;
        }

        .app-container.active {
            display: block;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .top-nav {
            background: white;
            border-radius: 20px;
            padding: 15px 30px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: var(--shadow);
        }

        .logo {
            font-family: 'Fredoka', sans-serif;
            font-size: 1.5rem;
            background: linear-gradient(135deg, var(--primary-purple) 0%, var(--primary-pink) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .user-menu {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-purple) 0%, var(--primary-pink) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 3px solid white;
            box-shadow: var(--shadow);
        }

        .user-avatar:hover {
            transform: scale(1.1);
        }

        .nav-btn {
            padding: 8px 20px;
            background: var(--primary-blue);
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .nav-btn:hover {
            background: #2563EB;
            transform: translateY(-2px);
        }

        .logout-btn {
            padding: 8px 20px;
            background: #EF4444;
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .logout-btn:hover {
            background: #DC2626;
            transform: translateY(-2px);
        }

        header {
            background: linear-gradient(135deg, var(--primary-purple) 0%, var(--primary-pink) 100%);
            border-radius: 30px;
            padding: 40px;
            box-shadow: var(--shadow-lg);
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -10%;
            width: 400px;
            height: 400px;
            background: rgba(255,255,255,0.1);
            border-radius: 50%;
        }

        .header-content {
            position: relative;
            z-index: 1;
        }

        h1 {
            font-family: 'Fredoka', sans-serif;
            font-size: 2.5rem;
            color: white;
            text-align: center;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.2);
            margin-bottom: 10px;
        }

        .welcome-message {
            text-align: center;
            color: white;
            font-size: 1.5rem;
            font-weight: 600;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            border-radius: 20px;
            padding: 25px;
            box-shadow: var(--shadow);
            text-align: center;
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        .stat-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .stat-value {
            font-family: 'Fredoka', sans-serif;
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary-purple) 0%, var(--primary-pink) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 5px;
        }

        .stat-label {
            color: var(--text-medium);
            font-weight: 600;
        }

        .learning-areas {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .learning-card {
            background: white;
            border-radius: 25px;
            padding: 30px;
            box-shadow: var(--shadow);
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
            overflow: hidden;
        }

        .learning-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            transition: height 0.3s ease;
        }

        .learning-card:hover::before {
            height: 100%;
            opacity: 0.1;
        }

        .learning-card.math::before { background: var(--primary-blue); }
        .learning-card.reading::before { background: var(--primary-green); }
        .learning-card.spelling::before { background: var(--primary-orange); }
        .learning-card.coding::before { background: var(--primary-pink); }
        .learning-card.ai::before { background: var(--primary-purple); }

        .learning-card:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
        }

        .card-icon {
            font-size: 3.5rem;
            margin-bottom: 15px;
            display: inline-block;
            animation: bounce 2s ease-in-out infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .card-title {
            font-family: 'Fredoka', sans-serif;
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 10px;
            position: relative;
            z-index: 1;
        }

        .card-description {
            color: var(--text-medium);
            margin-bottom: 20px;
            line-height: 1.6;
            position: relative;
            z-index: 1;
        }

        .difficulty-badge {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-bottom: 15px;
        }

        .difficulty-easy { background: #D1FAE5; color: #065F46; }
        .difficulty-medium { background: #FEF3C7; color: #92400E; }
        .difficulty-hard { background: #FEE2E2; color: #991B1B; }

        .progress-container {
            position: relative;
            z-index: 1;
        }

        .progress-bar {
            background: #E5E7EB;
            height: 10px;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 10px;
        }

        .progress-fill {
            height: 100%;
            border-radius: 10px;
            transition: width 0.5s ease;
            position: relative;
            overflow: hidden;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            bottom: 0;
            right: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .progress-fill.math { background: linear-gradient(90deg, var(--primary-blue) 0%, #60A5FA 100%); }
        .progress-fill.reading { background: linear-gradient(90deg, var(--primary-green) 0%, #34D399 100%); }
        .progress-fill.spelling { background: linear-gradient(90deg, var(--primary-orange) 0%, #FB923C 100%); }
        .progress-fill.coding { background: linear-gradient(90deg, var(--primary-pink) 0%, #F472B6 100%); }
        .progress-fill.ai { background: linear-gradient(90deg, var(--primary-purple) 0%, #A78BFA 100%); }

        .progress-text {
            display: flex;
            justify-content: space-between;
            font-size: 0.9rem;
            color: var(--text-medium);
            font-weight: 600;
        }

        .leaderboard {
            background: white;
            border-radius: 25px;
            padding: 35px;
            box-shadow: var(--shadow);
        }

        .leaderboard-title {
            font-family: 'Fredoka', sans-serif;
            font-size: 2.2rem;
            font-weight: 700;
            margin-bottom: 25px;
            text-align: center;
            background: linear-gradient(135deg, var(--primary-purple) 0%, var(--primary-pink) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .leaderboard-list {
            list-style: none;
        }

        .leaderboard-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 18px 20px;
            margin-bottom: 12px;
            border-radius: 15px;
            background: #F9FAFB;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .leaderboard-item::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            width: 4px;
            background: var(--primary-purple);
            transform: scaleY(0);
            transition: transform 0.3s ease;
        }

        .leaderboard-item:hover {
            transform: translateX(10px);
            box-shadow: var(--shadow);
        }

        .leaderboard-item:hover::before {
            transform: scaleY(1);
        }

        .leaderboard-item.current-user {
            background: linear-gradient(135deg, #FEF3C7 0%, #FDE68A 100%);
            border: 2px solid var(--primary-yellow);
        }

        .leaderboard-item.top-1 {
            background: linear-gradient(135deg, #FCD34D 0%, #F59E0B 100%);
            color: white;
        }

        .leaderboard-item.top-2 {
            background: linear-gradient(135deg, #E5E7EB 0%, #D1D5DB 100%);
        }

        .leaderboard-item.top-3 {
            background: linear-gradient(135deg, #FBBF24 0%, #F59E0B 100%);
        }

        .rank {
            font-family: 'Fredoka', sans-serif;
            font-size: 1.5rem;
            font-weight: 700;
            width: 50px;
            text-align: center;
        }

        .player-info {
            flex: 1;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .player-avatar {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            border: 2px solid rgba(0,0,0,0.1);
        }

        .player-name {
            font-weight: 600;
            font-size: 1.1rem;
        }

        .player-points {
            font-family: 'Fredoka', sans-serif;
            font-size: 1.4rem;
            font-weight: 700;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            animation: fadeIn 0.3s ease;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 30px;
            padding: 40px;
            max-width: 800px;
            width: 90%;
            max-height: 85vh;
            overflow-y: auto;
            box-shadow: var(--shadow-lg);
            animation: modalSlide 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        @keyframes modalSlide {
            from { transform: scale(0.7) translateY(-50px); opacity: 0; }
            to { transform: scale(1) translateY(0); opacity: 1; }
        }

        .modal-header {
            font-family: 'Fredoka', sans-serif;
            font-size: 2.2rem;
            font-weight: 700;
            margin-bottom: 25px;
            text-align: center;
            background: linear-gradient(135deg, var(--primary-purple) 0%, var(--primary-pink) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .close-btn {
            background: linear-gradient(135deg, var(--primary-pink) 0%, var(--primary-purple) 100%);
            color: white;
            border: none;
            border-radius: 15px;
            padding: 12px 35px;
            font-family: 'Fredoka', sans-serif;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            margin-top: 20px;
            transition: all 0.3s ease;
            display: block;
            margin-left: auto;
            margin-right: auto;
        }

        .close-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(236, 72, 153, 0.3);
        }

        .quiz-question {
            background: linear-gradient(135deg, #F9FAFB 0%, #F3F4F6 100%);
            padding: 25px;
            border-radius: 20px;
            margin-bottom: 25px;
            border-left: 5px solid var(--primary-purple);
        }

        .question-number {
            color: var(--primary-purple);
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 0.95rem;
        }

        .quiz-options {
            display: grid;
            gap: 12px;
            margin-top: 20px;
        }

        .quiz-option {
            background: white;
            border: 3px solid #E5E7EB;
            border-radius: 15px;
            padding: 18px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.05rem;
            font-weight: 500;
            position: relative;
            overflow: hidden;
        }

        .quiz-option::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            width: 0;
            background: linear-gradient(90deg, var(--primary-purple), var(--primary-pink));
            transition: width 0.3s ease;
            z-index: 0;
        }

        .quiz-option span {
            position: relative;
            z-index: 1;
        }

        .quiz-option:hover:not(.disabled) {
            border-color: var(--primary-purple);
            transform: translateX(8px);
        }

        .quiz-option.selected {
            border-color: var(--primary-purple);
            background: linear-gradient(135deg, var(--primary-purple) 0%, var(--primary-pink) 100%);
            color: white;
        }

        .quiz-option.correct {
            border-color: var(--primary-green);
            background: linear-gradient(135deg, var(--primary-green) 0%, #34D399 100%);
            color: white;
            animation: correctPulse 0.5s ease;
        }

        .quiz-option.incorrect {
            border-color: var(--primary-red);
            background: linear-gradient(135deg, var(--primary-red) 0%, #F87171 100%);
            color: white;
            animation: shake 0.5s ease;
        }

        .quiz-option.disabled {
            cursor: not-allowed;
            opacity: 0.7;
        }

        @keyframes correctPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        .feedback-box {
            margin-top: 20px;
            padding: 20px;
            border-radius: 15px;
            display: none;
            animation: slideDown 0.4s ease;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .feedback-box.show {
            display: block;
        }

        .feedback-box.correct {
            background: linear-gradient(135deg, #D1FAE5 0%, #A7F3D0 100%);
            border-left: 5px solid var(--primary-green);
        }

        .feedback-box.incorrect {
            background: linear-gradient(135deg, #FEE2E2 0%, #FECACA 100%);
            border-left: 5px solid var(--primary-red);
        }

        .feedback-title {
            font-family: 'Fredoka', sans-serif;
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .feedback-text {
            line-height: 1.6;
            margin-bottom: 10px;
        }

        .next-question-btn {
            background: linear-gradient(135deg, var(--primary-blue) 0%, #60A5FA 100%);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 12px 30px;
            font-family: 'Fredoka', sans-serif;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 15px;
        }

        .next-question-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(59, 130, 246, 0.4);
        }

        .submit-quiz {
            background: linear-gradient(135deg, var(--primary-green) 0%, #34D399 100%);
            color: white;
            border: none;
            border-radius: 15px;
            padding: 18px 45px;
            font-family: 'Fredoka', sans-serif;
            font-size: 1.3rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: block;
            margin: 25px auto;
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
        }

        .submit-quiz:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(16, 185, 129, 0.4);
        }

        .submit-quiz:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .celebration {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 6rem;
            opacity: 0;
            pointer-events: none;
            z-index: 3000;
        }

        .celebration.show {
            animation: celebrate 1.5s ease-out;
        }

        @keyframes celebrate {
            0% { opacity: 0; transform: translate(-50%, -50%) scale(0) rotate(0deg); }
            50% { opacity: 1; transform: translate(-50%, -50%) scale(1.5) rotate(180deg); }
            100% { opacity: 0; transform: translate(-50%, -50%) scale(1) rotate(360deg); }
        }

        /* Parent Dashboard */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .dashboard-card {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: var(--shadow);
        }

        .dashboard-card h3 {
            font-family: 'Fredoka', sans-serif;
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: var(--primary-purple);
        }

        .child-card {
            background: #F9FAFB;
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .child-card:hover {
            background: #F3F4F6;
            transform: translateX(5px);
        }

        .child-name {
            font-weight: 700;
            font-size: 1.1rem;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .mini-stat {
            display: flex;
            justify-content: space-between;
            font-size: 0.9rem;
            color: var(--text-medium);
            margin-bottom: 5px;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .login-box { padding: 30px; }
            h1 { font-size: 2rem; }
            .stats-grid { grid-template-columns: repeat(2, 1fr); }
            .learning-areas { grid-template-columns: 1fr; }
            .user-menu { gap: 10px; }
            .avatar-selection { grid-template-columns: repeat(3, 1fr); }
            .user-type-selector { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="stars" id="stars"></div>
    <div class="celebration" id="celebration">üéâ</div>

    <!-- Login Screen -->
    <div class="login-container" id="loginScreen">
        <div class="login-box">
            <div class="login-logo">üöÄ LearnQuest</div>
            <p class="login-subtitle">Start Your Learning Adventure!</p>
            
            <div class="user-type-selector" id="userTypeSelector">
                <button class="user-type-btn" data-type="student">
                    <div style="font-size: 2rem; margin-bottom: 8px;">üéì</div>
                    Student
                </button>
                <button class="user-type-btn" data-type="parent">
                    <div style="font-size: 2rem; margin-bottom: 8px;">üë®‚Äçüë©‚Äçüëß</div>
                    Parent
                </button>
            </div>

            <div id="studentForm" style="display: none;">
                <div class="form-group">
                    <label class="form-label">Your Name</label>
                    <input type="text" class="form-input" id="userName" placeholder="Enter your name" maxlength="20">
                </div>

                <div class="form-group">
                    <label class="form-label">How old are you?</label>
                    <div class="age-selector" id="ageSelector"></div>
                </div>

                <div class="form-group">
                    <label class="form-label">Choose Your Avatar</label>
                    <div class="avatar-selection" id="avatarSelector">
                        <div class="avatar-option" data-avatar="ü¶Å">ü¶Å</div>
                        <div class="avatar-option" data-avatar="üêº">üêº</div>
                        <div class="avatar-option" data-avatar="ü¶ä">ü¶ä</div>
                        <div class="avatar-option" data-avatar="üê®">üê®</div>
                        <div class="avatar-option" data-avatar="ü¶â">ü¶â</div>
                        <div class="avatar-option" data-avatar="üê∏">üê∏</div>
                        <div class="avatar-option" data-avatar="ü¶Ñ">ü¶Ñ</div>
                        <div class="avatar-option" data-avatar="üê≤">üê≤</div>
                        <div class="avatar-option" data-avatar="üöÄ">üöÄ</div>
                        <div class="avatar-option" data-avatar="‚≠ê">‚≠ê</div>
                        <div class="avatar-option" data-avatar="üåà">üåà</div>
                        <div class="avatar-option" data-avatar="üé®">üé®</div>
                    </div>
                </div>

                <button class="btn-primary" onclick="login()">Start Learning! üéì</button>
            </div>

            <div id="parentForm" style="display: none;">
                <div class="form-group">
                    <label class="form-label">Parent Name</label>
                    <input type="text" class="form-input" id="parentName" placeholder="Enter your name" maxlength="20">
                </div>

                <div class="form-group">
                    <label class="form-label">Access Code (Create one)</label>
                    <input type="password" class="form-input" id="parentCode" placeholder="Create a 4-digit code" maxlength="4">
                </div>

                <button class="btn-primary" onclick="parentLogin()">Access Dashboard üìä</button>
            </div>
        </div>
    </div>

    <!-- Student App -->
    <div class="app-container" id="appContainer">
        <div class="container">
            <div class="top-nav">
                <div class="logo">üöÄ LearnQuest Academy</div>
                <div class="user-menu">
                    <span id="navUserName" style="font-weight: 600;"></span>
                    <div class="user-avatar" id="navUserAvatar" onclick="showProfile()"></div>
                    <button class="logout-btn" onclick="logout()">Logout</button>
                </div>
            </div>

            <header>
                <div class="header-content">
                    <h1>üåü Welcome Back, <span id="headerUserName"></span>!</h1>
                    <p class="welcome-message" id="welcomeMessage">Ready to learn something amazing today?</p>
                </div>
            </header>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">üèÜ</div>
                    <div class="stat-value" id="userLevel">1</div>
                    <div class="stat-label">Level</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">‚≠ê</div>
                    <div class="stat-value" id="userPoints">0</div>
                    <div class="stat-label">Total Points</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">üéØ</div>
                    <div class="stat-value" id="userRank">-</div>
                    <div class="stat-label">Rank</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">üî•</div>
                    <div class="stat-value" id="userStreak">0</div>
                    <div class="stat-label">Day Streak</div>
                </div>
            </div>

            <div class="learning-areas" id="learningAreas"></div>

            <div class="leaderboard">
                <h2 class="leaderboard-title">üèÜ Top Learners</h2>
                <ul class="leaderboard-list" id="leaderboardList"></ul>
            </div>
        </div>
    </div>

    <!-- Parent Dashboard -->
    <div class="app-container" id="parentDashboard">
        <div class="container">
            <div class="top-nav">
                <div class="logo">üë®‚Äçüë©‚Äçüëß Parent Dashboard</div>
                <div class="user-menu">
                    <span id="parentNavName" style="font-weight: 600;"></span>
                    <button class="logout-btn" onclick="logout()">Logout</button>
                </div>
            </div>

            <header>
                <div class="header-content">
                    <h1>üìä Learning Progress Overview</h1>
                    <p class="welcome-message">Monitor your children's learning journey</p>
                </div>
            </header>

            <div class="dashboard-grid">
                <div class="dashboard-card">
                    <h3>üë∂ Your Children</h3>
                    <div id="childrenList"></div>
                </div>

                <div class="dashboard-card">
                    <h3>üìà Overall Stats</h3>
                    <div id="overallStats"></div>
                </div>

                <div class="dashboard-card">
                    <h3>üéØ Recent Activity</h3>
                    <div id="recentActivity"></div>
                </div>
            </div>

            <div class="dashboard-card" style="margin-top: 25px;">
                <h3>üìö Detailed Progress</h3>
                <div id="detailedProgress"></div>
            </div>
        </div>
    </div>

    <!-- Activity Modal -->
    <div class="modal" id="activityModal">
        <div class="modal-content">
            <h2 class="modal-header" id="modalTitle">Activity</h2>
            <div id="modalBody"></div>
            <button class="close-btn" onclick="closeModal()">Close</button>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>

    <script>
        // Global state
        let currentUser = null;
        let selectedAge = null;
        let selectedAvatar = null;
        let allUsers = [];
        let userType = null;
        let currentQuestionIndex = 0;
        let currentActivity = null;
        let quizAnswers = [];

        // Create stars
        function createStars() {
            const starsContainer = document.getElementById('stars');
            for (let i = 0; i < 40; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.animationDelay = Math.random() * 3 + 's';
                starsContainer.appendChild(star);
            }
        }
        createStars();

        // User type selection
        document.getElementById('userTypeSelector').addEventListener('click', (e) => {
            const btn = e.target.closest('.user-type-btn');
            if (btn) {
                document.querySelectorAll('.user-type-btn').forEach(b => b.classList.remove('selected'));
                btn.classList.add('selected');
                userType = btn.dataset.type;
                
                document.getElementById('studentForm').style.display = userType === 'student' ? 'block' : 'none';
                document.getElementById('parentForm').style.display = userType === 'parent' ? 'block' : 'none';
            }
        });

        // Generate age buttons
        function generateAgeButtons() {
            const ageSelector = document.getElementById('ageSelector');
            for (let i = 6; i <= 15; i++) {
                const btn = document.createElement('button');
                btn.className = 'age-btn';
                btn.dataset.age = i;
                btn.textContent = i;
                btn.onclick = () => {
                    document.querySelectorAll('.age-btn').forEach(b => b.classList.remove('selected'));
                    btn.classList.add('selected');
                    selectedAge = i;
                };
                ageSelector.appendChild(btn);
            }
        }
        generateAgeButtons();

        // Avatar selection
        document.getElementById('avatarSelector').addEventListener('click', (e) => {
            if (e.target.classList.contains('avatar-option')) {
                document.querySelectorAll('.avatar-option').forEach(opt => opt.classList.remove('selected'));
                e.target.classList.add('selected');
                selectedAvatar = e.target.dataset.avatar;
            }
        });

        // Student login
        async function login() {
            const userName = document.getElementById('userName').value.trim();
            
            if (!userName) {
                alert('Please enter your name! üòä');
                return;
            }
            
            if (!selectedAge) {
                alert('Please select your age! üéÇ');
                return;
            }
            
            if (!selectedAvatar) {
                alert('Please choose an avatar! üé®');
                return;
            }

            currentUser = {
                name: userName,
                age: selectedAge,
                avatar: selectedAvatar,
                level: 1,
                points: 0,
                streak: 0,
                progress: {
                    math: 0,
                    reading: 0,
                    spelling: 0,
                    coding: 0,
                    ai: 0
                },
                joinedDate: new Date().toISOString(),
                lastActive: new Date().toISOString()
            };

            try {
                await window.storage.set(`user:${userName}`, JSON.stringify(currentUser), true);
                localStorage.setItem('currentUser', userName);
                localStorage.setItem('userType', 'student');
                showApp();
            } catch (error) {
                console.error('Error saving user:', error);
                localStorage.setItem('currentUser', userName);
                localStorage.setItem('userType', 'student');
                localStorage.setItem(`user:${userName}`, JSON.stringify(currentUser));
                showApp();
            }
        }

        // Parent login
        async function parentLogin() {
            const parentName = document.getElementById('parentName').value.trim();
            const parentCode = document.getElementById('parentCode').value.trim();
            
            if (!parentName || !parentCode) {
                alert('Please fill in all fields! üìù');
                return;
            }
            
            if (parentCode.length !== 4) {
                alert('Access code must be 4 digits! üî¢');
                return;
            }

            const parentData = {
                name: parentName,
                code: parentCode,
                children: []
            };

            try {
                await window.storage.set(`parent:${parentName}`, JSON.stringify(parentData), true);
                localStorage.setItem('currentParent', parentName);
                localStorage.setItem('userType', 'parent');
                currentUser = parentData;
                showParentDashboard();
            } catch (error) {
                console.error('Error saving parent:', error);
                localStorage.setItem('currentParent', parentName);
                localStorage.setItem('userType', 'parent');
                localStorage.setItem(`parent:${parentName}`, JSON.stringify(parentData));
                currentUser = parentData;
                showParentDashboard();
            }
        }

        // Load user
        async function loadUser() {
            const savedUserType = localStorage.getItem('userType');
            
            if (savedUserType === 'student') {
                const userName = localStorage.getItem('currentUser');
                if (!userName) return false;

                try {
                    const result = await window.storage.get(`user:${userName}`, true);
                    if (result && result.value) {
                        currentUser = JSON.parse(result.value);
                        return true;
                    }
                } catch (error) {
                    const userData = localStorage.getItem(`user:${userName}`);
                    if (userData) {
                        currentUser = JSON.parse(userData);
                        return true;
                    }
                }
            } else if (savedUserType === 'parent') {
                const parentName = localStorage.getItem('currentParent');
                if (!parentName) return false;

                try {
                    const result = await window.storage.get(`parent:${parentName}`, true);
                    if (result && result.value) {
                        currentUser = JSON.parse(result.value);
                        return true;
                    }
                } catch (error) {
                    const parentData = localStorage.getItem(`parent:${parentName}`);
                    if (parentData) {
                        currentUser = JSON.parse(parentData);
                        return true;
                    }
                }
            }
            return false;
        }

        // Learning paths based on age
        function getLearningPath(age) {
            if (age >= 6 && age <= 8) {
                return {
                    math: { difficulty: 'easy', topics: ['Addition', 'Subtraction', 'Counting', 'Shapes'] },
                    reading: { difficulty: 'easy', topics: ['Simple Stories', 'Phonics', 'Sight Words'] },
                    spelling: { difficulty: 'easy', topics: ['3-Letter Words', '4-Letter Words'] },
                    coding: { difficulty: 'easy', topics: ['Block Coding', 'Sequences', 'Patterns'] },
                    ai: { difficulty: 'easy', topics: ['What is AI?', 'Pattern Recognition'] }
                };
            } else if (age >= 9 && age <= 11) {
                return {
                    math: { difficulty: 'medium', topics: ['Multiplication', 'Division', 'Fractions', 'Geometry'] },
                    reading: { difficulty: 'medium', topics: ['Chapter Books', 'Comprehension', 'Vocabulary'] },
                    spelling: { difficulty: 'medium', topics: ['5-6 Letter Words', 'Compound Words'] },
                    coding: { difficulty: 'medium', topics: ['Python Basics', 'Variables', 'Loops'] },
                    ai: { difficulty: 'medium', topics: ['Machine Learning Basics', 'Data Patterns'] }
                };
            } else {
                return {
                    math: { difficulty: 'hard', topics: ['Algebra', 'Equations', 'Advanced Geometry'] },
                    reading: { difficulty: 'hard', topics: ['Complex Texts', 'Analysis', 'Critical Thinking'] },
                    spelling: { difficulty: 'hard', topics: ['Advanced Vocabulary', 'Latin Roots'] },
                    coding: { difficulty: 'hard', topics: ['Functions', 'Algorithms', 'Problem Solving'] },
                    ai: { difficulty: 'hard', topics: ['Neural Networks', 'AI Ethics', 'Applications'] }
                };
            }
        }

        // Show app
        function showApp() {
            document.getElementById('loginScreen').style.display = 'none';
            document.getElementById('appContainer').classList.add('active');
            
            document.getElementById('headerUserName').textContent = currentUser.name;
            document.getElementById('navUserName').textContent = currentUser.name;
            document.getElementById('navUserAvatar').textContent = currentUser.avatar;
            document.getElementById('userLevel').textContent = currentUser.level;
            document.getElementById('userPoints').textContent = currentUser.points.toLocaleString();
            document.getElementById('userStreak').textContent = currentUser.streak;

            // Age-appropriate welcome message
            const messages = [
                "Ready to learn something amazing today?",
                "Let's make today awesome!",
                "Time to level up your skills!",
                "Your brain is going to love this!",
                "Adventure awaits in every lesson!"
            ];
            document.getElementById('welcomeMessage').textContent = messages[Math.floor(Math.random() * messages.length)];

            renderLearningCards();
            loadLeaderboard();
        }

        // Render learning cards based on age
        function renderLearningCards() {
            const learningPath = getLearningPath(currentUser.age);
            const learningAreas = document.getElementById('learningAreas');
            
            const cards = [
                { id: 'math', icon: 'üßÆ', title: 'Math Master', description: 'Solve puzzles and master numbers!' },
                { id: 'reading', icon: 'üìö', title: 'Reading Adventure', description: 'Explore amazing stories!' },
                { id: 'spelling', icon: '‚úèÔ∏è', title: 'Spelling Bee', description: 'Become a spelling superstar!' },
                { id: 'coding', icon: 'üíª', title: 'Coding Academy', description: 'Learn to code and build programs!' },
                { id: 'ai', icon: 'ü§ñ', title: 'AI Explorer', description: 'Discover how AI works!' }
            ];

            learningAreas.innerHTML = cards.map(card => {
                const path = learningPath[card.id];
                const progress = currentUser.progress[card.id] || 0;
                const percent = Math.round(progress);
                
                return `
                    <div class="learning-card ${card.id}" onclick="openActivity('${card.id}')">
                        <div class="card-icon">${card.icon}</div>
                        <span class="difficulty-badge difficulty-${path.difficulty}">${path.difficulty.toUpperCase()}</span>
                        <h3 class="card-title">${card.title}</h3>
                        <p class="card-description">${card.description}</p>
                        <div class="progress-container">
                            <div class="progress-bar">
                                <div class="progress-fill ${card.id}" style="width: ${percent}%;"></div>
                            </div>
                            <div class="progress-text">
                                <span>${Math.floor(progress)} completed</span>
                                <span>${percent}%</span>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Save user data
        async function saveUserData() {
            currentUser.lastActive = new Date().toISOString();
            try {
                await window.storage.set(`user:${currentUser.name}`, JSON.stringify(currentUser), true);
                localStorage.setItem(`user:${currentUser.name}`, JSON.stringify(currentUser));
            } catch (error) {
                console.error('Error saving user data:', error);
                localStorage.setItem(`user:${currentUser.name}`, JSON.stringify(currentUser));
            }
        }

        // Load leaderboard
        async function loadLeaderboard() {
            try {
                const result = await window.storage.list('user:', true);
                if (result && result.keys) {
                    const userPromises = result.keys.map(async key => {
                        try {
                            const userData = await window.storage.get(key, true);
                            return userData && userData.value ? JSON.parse(userData.value) : null;
                        } catch {
                            return null;
                        }
                    });
                    
                    allUsers = (await Promise.all(userPromises)).filter(u => u !== null);
                }
            } catch (error) {
                console.error('Error loading leaderboard:', error);
                allUsers = [];
            }

            if (!allUsers.find(u => u.name === currentUser.name)) {
                allUsers.push(currentUser);
            }

            allUsers.sort((a, b) => b.points - a.points);

            const userRank = allUsers.findIndex(u => u.name === currentUser.name) + 1;
            document.getElementById('userRank').textContent = userRank;

            const leaderboardList = document.getElementById('leaderboardList');
            leaderboardList.innerHTML = '';

            allUsers.slice(0, 10).forEach((user, index) => {
                const li = document.createElement('li');
                li.className = 'leaderboard-item';
                
                if (index === 0) li.classList.add('top-1');
                else if (index === 1) li.classList.add('top-2');
                else if (index === 2) li.classList.add('top-3');
                
                if (user.name === currentUser.name) {
                    li.classList.add('current-user');
                }

                const rankEmoji = index === 0 ? 'ü•á' : index === 1 ? 'ü•à' : index === 2 ? 'ü•â' : (index + 1);

                li.innerHTML = `
                    <span class="rank">${rankEmoji}</span>
                    <div class="player-info">
                        <div class="player-avatar">${user.avatar}</div>
                        <span class="player-name">${user.name}</span>
                    </div>
                    <span class="player-points">${user.points.toLocaleString()} pts</span>
                `;
                
                leaderboardList.appendChild(li);
            });
        }

        // Parent Dashboard
        async function showParentDashboard() {
            document.getElementById('loginScreen').style.display = 'none';
            document.getElementById('parentDashboard').classList.add('active');
            
            document.getElementById('parentNavName').textContent = currentUser.name;

            // Load all students
            try {
                const result = await window.storage.list('user:', true);
                if (result && result.keys) {
                    const userPromises = result.keys.map(async key => {
                        try {
                            const userData = await window.storage.get(key, true);
                            return userData && userData.value ? JSON.parse(userData.value) : null;
                        } catch {
                            return null;
                        }
                    });
                    
                    allUsers = (await Promise.all(userPromises)).filter(u => u !== null);
                }
            } catch (error) {
                console.error('Error loading users:', error);
            }

            renderParentDashboard();
        }

        // Render parent dashboard
        function renderParentDashboard() {
            const childrenList = document.getElementById('childrenList');
            const overallStats = document.getElementById('overallStats');
            const recentActivity = document.getElementById('recentActivity');
            const detailedProgress = document.getElementById('detailedProgress');

            // Children list
            if (allUsers.length === 0) {
                childrenList.innerHTML = '<p style="color: var(--text-medium);">No students registered yet.</p>';
            } else {
                childrenList.innerHTML = allUsers.map(user => `
                    <div class="child-card">
                        <div class="child-name">
                            <span>${user.avatar}</span>
                            <span>${user.name}</span>
                            <span style="font-size: 0.85rem; color: var(--text-medium); font-weight: 400;">(Age ${user.age})</span>
                        </div>
                        <div class="mini-stat">
                            <span>Level:</span>
                            <span style="font-weight: 700;">${user.level}</span>
                        </div>
                        <div class="mini-stat">
                            <span>Points:</span>
                            <span style="font-weight: 700;">${user.points}</span>
                        </div>
                        <div class="mini-stat">
                            <span>Streak:</span>
                            <span style="font-weight: 700;">${user.streak} days</span>
                        </div>
                    </div>
                `).join('');
            }

            // Overall stats
            const totalPoints = allUsers.reduce((sum, u) => sum + u.points, 0);
            const avgLevel = allUsers.length > 0 ? (allUsers.reduce((sum, u) => sum + u.level, 0) / allUsers.length).toFixed(1) : 0;
            
            overallStats.innerHTML = `
                <div class="mini-stat" style="margin-bottom: 15px;">
                    <span>Total Students:</span>
                    <span style="font-weight: 700; font-size: 1.2rem;">${allUsers.length}</span>
                </div>
                <div class="mini-stat" style="margin-bottom: 15px;">
                    <span>Combined Points:</span>
                    <span style="font-weight: 700; font-size: 1.2rem;">${totalPoints.toLocaleString()}</span>
                </div>
                <div class="mini-stat">
                    <span>Average Level:</span>
                    <span style="font-weight: 700; font-size: 1.2rem;">${avgLevel}</span>
                </div>
            `;

            // Recent activity
            const sorted = [...allUsers].sort((a, b) => new Date(b.lastActive) - new Date(a.lastActive));
            recentActivity.innerHTML = sorted.slice(0, 5).map(user => `
                <div class="mini-stat" style="margin-bottom: 12px; padding: 10px; background: #F9FAFB; border-radius: 8px;">
                    <span>${user.avatar} ${user.name}</span>
                    <span style="font-size: 0.85rem; color: var(--text-medium);">${timeAgo(user.lastActive)}</span>
                </div>
            `).join('');

            // Detailed progress
            detailedProgress.innerHTML = allUsers.map(user => `
                <div style="margin-bottom: 30px; padding: 20px; background: #F9FAFB; border-radius: 15px;">
                    <h4 style="margin-bottom: 15px; font-size: 1.2rem;">${user.avatar} ${user.name}'s Progress</h4>
                    ${Object.entries(user.progress).map(([subject, progress]) => `
                        <div style="margin-bottom: 12px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 5px; font-size: 0.9rem;">
                                <span style="text-transform: capitalize;">${subject}</span>
                                <span style="font-weight: 700;">${Math.round(progress)}%</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill ${subject}" style="width: ${Math.round(progress)}%;"></div>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `).join('');
        }

        // Time ago helper
        function timeAgo(dateString) {
            const seconds = Math.floor((new Date() - new Date(dateString)) / 1000);
            
            if (seconds < 60) return 'Just now';
            if (seconds < 3600) return Math.floor(seconds / 60) + ' min ago';
            if (seconds < 86400) return Math.floor(seconds / 3600) + ' hrs ago';
            return Math.floor(seconds / 86400) + ' days ago';
        }

        // Logout
        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                localStorage.clear();
                location.reload();
            }
        }

        // Show profile
        function showProfile() {
            const info = `
üë§ Name: ${currentUser.name}
üéÇ Age: ${currentUser.age}
üèÜ Level: ${currentUser.level}
‚≠ê Points: ${currentUser.points}
üî• Streak: ${currentUser.streak} days
üìÖ Joined: ${new Date(currentUser.joinedDate).toLocaleDateString()}
            `;
            alert(info);
        }

        // Quiz database with explanations
        const quizDatabase = {
            math: {
                easy: [
                    {
                        question: 'What is 5 + 7?',
                        options: ['10', '11', '12', '13'],
                        correct: 2,
                        explanation: 'When we add 5 + 7, we can count up from 5: 6, 7, 8, 9, 10, 11, 12. The answer is 12!'
                    },
                    {
                        question: 'How many sides does a triangle have?',
                        options: ['2', '3', '4', '5'],
                        correct: 1,
                        explanation: 'A triangle always has exactly 3 sides and 3 corners. That\'s why it\'s called a "tri-angle" (tri means three)!'
                    },
                    {
                        question: 'What is 10 - 4?',
                        options: ['5', '6', '7', '8'],
                        correct: 1,
                        explanation: 'If we start with 10 and take away 4, we have 6 left. Try counting: 10, 9, 8, 7, 6!'
                    }
                ],
                medium: [
                    {
                        question: 'What is 12 √ó 8?',
                        options: ['86', '96', '106', '116'],
                        correct: 1,
                        explanation: 'To multiply 12 √ó 8, think of it as (10 √ó 8) + (2 √ó 8) = 80 + 16 = 96. Breaking big problems into smaller ones helps!'
                    },
                    {
                        question: 'What is 3/4 + 1/4?',
                        options: ['1/2', '3/4', '1', '4/8'],
                        correct: 2,
                        explanation: 'When the denominators (bottom numbers) are the same, just add the numerators (top numbers): 3 + 1 = 4. So 4/4 = 1 whole!'
                    }
                ],
                hard: [
                    {
                        question: 'Solve for x: 3x + 7 = 22',
                        options: ['3', '4', '5', '6'],
                        correct: 2,
                        explanation: 'First subtract 7 from both sides: 3x = 15. Then divide both sides by 3: x = 5. Always do the opposite operation!'
                    },
                    {
                        question: 'What is the area of a rectangle with length 12cm and width 7cm?',
                        options: ['19 cm¬≤', '38 cm¬≤', '72 cm¬≤', '84 cm¬≤'],
                        correct: 3,
                        explanation: 'Area of a rectangle = length √ó width. So 12 √ó 7 = 84 square centimeters (cm¬≤)!'
                    }
                ]
            },
            coding: {
                easy: [
                    {
                        question: 'In block coding, what does a "loop" do?',
                        options: ['Makes the program stop', 'Repeats actions', 'Deletes code', 'Changes colors'],
                        correct: 1,
                        explanation: 'A loop repeats the same actions over and over! It\'s like telling your robot "do this 5 times" instead of writing it 5 times. Very useful!'
                    },
                    {
                        question: 'What is a "bug" in coding?',
                        options: ['An insect', 'A mistake in code', 'A game character', 'A button'],
                        correct: 1,
                        explanation: 'A "bug" is a mistake or error in your code. The term comes from an actual moth that got stuck in an old computer! Debugging means fixing these mistakes.'
                    }
                ],
                medium: [
                    {
                        question: 'In Python, what does this code print?\nprint(5 + 3 * 2)',
                        options: ['10', '11', '16', '13'],
                        correct: 1,
                        explanation: 'Python follows math order of operations (PEMDAS)! Multiply first: 3 √ó 2 = 6, then add: 5 + 6 = 11.'
                    },
                    {
                        question: 'What type of variable is "name = \'Alex\'"?',
                        options: ['Number', 'String', 'Boolean', 'List'],
                        correct: 1,
                        explanation: 'Text in quotes is called a "string" in programming. Strings can hold letters, words, or sentences!'
                    }
                ],
                hard: [
                    {
                        question: 'What will this code output?\nfor i in range(3):\n    print(i * 2)',
                        options: ['0, 2, 4', '2, 4, 6', '0, 1, 2', '1, 2, 3'],
                        correct: 0,
                        explanation: 'range(3) gives us 0, 1, 2. The loop multiplies each by 2: (0√ó2=0), (1√ó2=2), (2√ó2=4). Output: 0, 2, 4!'
                    }
                ]
            },
            reading: {
                easy: [
                    {
                        question: 'Story: "Sam found a lost puppy. He gave it water and food. Then he helped find its owner." What did Sam do first?',
                        options: ['Found the owner', 'Gave it food', 'Found a puppy', 'Played with puppy'],
                        correct: 2,
                        explanation: 'The story says "Sam found a lost puppy" first. This happened before giving it water and food. Always look for time order words like "first," "then," and "finally"!'
                    }
                ],
                medium: [
                    {
                        question: 'Read: "Despite the rain, Maya was determined to finish her garden." What does "determined" mean?',
                        options: ['Sad', 'Decided to do something no matter what', 'Confused', 'Happy'],
                        correct: 1,
                        explanation: 'Determined means you\'ve made up your mind and won\'t give up, even when it\'s hard. The word "despite" (even though) gives us a clue!'
                    }
                ],
                hard: [
                    {
                        question: 'In "The Road Not Taken," what does "Two roads diverged in a yellow wood" symbolize?',
                        options: ['Getting lost', 'Making life choices', 'Going for a walk', 'Autumn season'],
                        correct: 1,
                        explanation: 'The two roads symbolize different choices in life. The yellow wood (autumn) suggests a time of change. The poem is about choosing your own path!'
                    }
                ]
            },
            spelling: {
                easy: [
                    {
                        question: 'Which spelling is correct?',
                        options: ['FREND', 'FRIEND', 'FREIND', 'FRIND'],
                        correct: 1,
                        explanation: 'FRIEND is correct! Remember: "I" before "E" except after "C" - but FRIEND is an exception. Think "A FRIEND to the END"!'
                    }
                ],
                medium: [
                    {
                        question: 'How do you spell "very unusual"?',
                        options: ['EXTRAORDINARY', 'EXTRAORDINERY', 'EXTRAORDIANRY', 'EXTRODINARY'],
                        correct: 0,
                        explanation: 'EXTRAORDINARY is correct! Break it down: EXTRA + ORDINARY. It means beyond ordinary, super special!'
                    }
                ],
                hard: [
                    {
                        question: 'Which is correct for "existing everywhere at once"?',
                        options: ['UBIQUITUS', 'UBIQUITOUS', 'UBIQUITIOUS', 'UBIQUITEUS'],
                        correct: 1,
                        explanation: 'UBIQUITOUS is correct! It comes from Latin "ubique" meaning everywhere. Think of it as "u-bi-quit-ous" to remember the spelling!'
                    }
                ]
            },
            ai: {
                easy: [
                    {
                        question: 'What does AI need to learn?',
                        options: ['Magic', 'Data and examples', 'Batteries', 'Wi-Fi'],
                        correct: 1,
                        explanation: 'AI learns from data and examples, just like you learn from books and practice! The more examples it sees, the better it gets.'
                    }
                ],
                medium: [
                    {
                        question: 'What is "machine learning"?',
                        options: ['Teaching robots to walk', 'AI learning from data without being programmed', 'Building machines', 'Computer games'],
                        correct: 1,
                        explanation: 'Machine learning is when AI teaches itself by finding patterns in data! Instead of programming every rule, we let it discover patterns on its own.'
                    }
                ],
                hard: [
                    {
                        question: 'What is a neural network inspired by?',
                        options: ['The internet', 'The human brain', 'Power lines', 'Phone networks'],
                        correct: 1,
                        explanation: 'Neural networks are inspired by how neurons in our brains connect and work together! Each "neuron" in the network passes information to others, just like our brain cells.'
                    }
                ]
            }
        };

        // Open activity
        function openActivity(type) {
            const age = currentUser.age;
            let difficulty = 'easy';
            if (age >= 9 && age <= 11) difficulty = 'medium';
            if (age >= 12) difficulty = 'hard';

            const quizzes = quizDatabase[type][difficulty];
            if (!quizzes) {
                alert('Content coming soon for this age group!');
                return;
            }

            currentActivity = type;
            currentQuestionIndex = 0;
            quizAnswers = [];

            const modal = document.getElementById('activityModal');
            const modalTitle = document.getElementById('modalTitle');
            
            const icons = {
                math: 'üßÆ',
                reading: 'üìö',
                spelling: '‚úèÔ∏è',
                coding: 'üíª',
                ai: 'ü§ñ'
            };

            modalTitle.textContent = `${icons[type]} ${type.charAt(0).toUpperCase() + type.slice(1)} Quiz`;
            
            showQuestion();
            modal.classList.add('active');
        }

        // Show question
        function showQuestion() {
            const age = currentUser.age;
            let difficulty = 'easy';
            if (age >= 9 && age <= 11) difficulty = 'medium';
            if (age >= 12) difficulty = 'hard';

            const quizzes = quizDatabase[currentActivity][difficulty];
            const question = quizzes[currentQuestionIndex];
            const modalBody = document.getElementById('modalBody');

            modalBody.innerHTML = `
                <div class="quiz-question">
                    <div class="question-number">Question ${currentQuestionIndex + 1} of ${quizzes.length}</div>
                    <h4 style="margin-bottom: 15px; font-size: 1.2rem; line-height: 1.6; white-space: pre-wrap;">${question.question}</h4>
                    <div class="quiz-options">
                        ${question.options.map((opt, i) => `
                            <div class="quiz-option" data-index="${i}" onclick="checkAnswer(${i})">
                                <span>${opt}</span>
                            </div>
                        `).join('')}
                    </div>
                    <div class="feedback-box" id="feedbackBox"></div>
                </div>
            `;
        }

        // Check answer with immediate feedback
        function checkAnswer(selectedIndex) {
            const age = currentUser.age;
            let difficulty = 'easy';
            if (age >= 9 && age <= 11) difficulty = 'medium';
            if (age >= 12) difficulty = 'hard';

            const quizzes = quizDatabase[currentActivity][difficulty];
            const question = quizzes[currentQuestionIndex];
            const options = document.querySelectorAll('.quiz-option');
            const feedbackBox = document.getElementById('feedbackBox');

            // Disable all options
            options.forEach(opt => opt.classList.add('disabled'));

            const isCorrect = selectedIndex === question.correct;
            quizAnswers.push(isCorrect);

            // Mark selected answer
            if (isCorrect) {
                options[selectedIndex].classList.add('correct');
                feedbackBox.className = 'feedback-box correct show';
                feedbackBox.innerHTML = `
                    <div class="feedback-title">üéâ Excellent! That's Correct!</div>
                    <div class="feedback-text">${question.explanation}</div>
                    ${currentQuestionIndex < quizzes.length - 1 ? 
                        '<button class="next-question-btn" onclick="nextQuestion()">Next Question ‚Üí</button>' :
                        '<button class="next-question-btn" onclick="finishQuiz()">See Results üéä</button>'
                    }
                `;
                showCelebration();
            } else {
                options[selectedIndex].classList.add('incorrect');
                options[question.correct].classList.add('correct');
                feedbackBox.className = 'feedback-box incorrect show';
                feedbackBox.innerHTML = `
                    <div class="feedback-title">üí° Not Quite! Let's Learn Together</div>
                    <div class="feedback-text">
                        <strong>The correct answer is: ${question.options[question.correct]}</strong><br><br>
                        ${question.explanation}
                    </div>
                    ${currentQuestionIndex < quizzes.length - 1 ? 
                        '<button class="next-question-btn" onclick="nextQuestion()">Next Question ‚Üí</button>' :
                        '<button class="next-question-btn" onclick="finishQuiz()">See Results üéä</button>'
                    }
                `;
            }
        }

        // Next question
        function nextQuestion() {
            currentQuestionIndex++;
            showQuestion();
        }

        // Finish quiz
        async function finishQuiz() {
            const correct = quizAnswers.filter(a => a).length;
            const total = quizAnswers.length;
            const percentage = Math.round((correct / total) * 100);
            const pointsEarned = correct * 100;

            // Update user stats
            currentUser.points += pointsEarned;
            currentUser.progress[currentActivity] = Math.min(100, (currentUser.progress[currentActivity] || 0) + (correct * 10));

            // Level up check
            const newLevel = Math.floor(currentUser.points / 500) + 1;
            const leveledUp = newLevel > currentUser.level;
            currentUser.level = newLevel;

            await saveUserData();

            // Show results
            const modalBody = document.getElementById('modalBody');
            const encouragement = percentage >= 80 ? 'Outstanding! üåü' : 
                                percentage >= 60 ? 'Great job! üéØ' : 
                                'Keep learning! üí™';

            modalBody.innerHTML = `
                <div style="text-align: center; padding: 20px;">
                    <div style="font-size: 5rem; margin-bottom: 20px;">${percentage >= 80 ? 'üèÜ' : percentage >= 60 ? 'üéâ' : 'üìö'}</div>
                    <h2 style="font-family: 'Fredoka', sans-serif; font-size: 2rem; margin-bottom: 15px;">${encouragement}</h2>
                    <div style="background: #F9FAFB; padding: 25px; border-radius: 20px; margin-bottom: 20px;">
                        <div style="font-size: 3rem; font-weight: 700; color: var(--primary-purple); margin-bottom: 10px;">
                            ${correct}/${total}
                        </div>
                        <div style="color: var(--text-medium); margin-bottom: 20px;">Questions Correct</div>
                        <div style="font-size: 2rem; font-weight: 700; color: var(--primary-green);">
                            +${pointsEarned} Points!
                        </div>
                    </div>
                    ${leveledUp ? `
                        <div style="background: linear-gradient(135deg, #FCD34D 0%, #F59E0B 100%); 
                                    padding: 20px; border-radius: 15px; color: white; margin-bottom: 20px;">
                            <div style="font-size: 2rem; margin-bottom: 10px;">üéä LEVEL UP! üéä</div>
                            <div style="font-size: 1.5rem; font-weight: 700;">You're now Level ${currentUser.level}!</div>
                        </div>
                    ` : ''}
                    <button class="close-btn" onclick="closeModalAndRefresh()">Continue Learning! üöÄ</button>
                </div>
            `;

            showCelebration();
        }

        // Close modal and refresh
        function closeModalAndRefresh() {
            closeModal();
            document.getElementById('userLevel').textContent = currentUser.level;
            document.getElementById('userPoints').textContent = currentUser.points.toLocaleString();
            renderLearningCards();
            loadLeaderboard();
        }

        // Close modal
        function closeModal() {
            document.getElementById('activityModal').classList.remove('active');
        }

        // Show celebration
        function showCelebration() {
            const celebration = document.getElementById('celebration');
            const emojis = ['üéâ', 'üåü', '‚≠ê', 'üèÜ', 'üéä', '‚ú®', 'üöÄ', 'üí´'];
            celebration.textContent = emojis[Math.floor(Math.random() * emojis.length)];
            celebration.classList.add('show');
            setTimeout(() => celebration.classList.remove('show'), 1500);
        }

        // Initialize app
        async function init() {
            const hasUser = await loadUser();
            if (hasUser) {
                const userType = localStorage.getItem('userType');
                if (userType === 'student') {
                    showApp();
                } else if (userType === 'parent') {
                    showParentDashboard();
                }
            }
        }

        init();
    </script>
</body>
</html>