<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Audit Logging Dashboard | Kiran Regmi</title>
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Vercel Web Analytics -->
    <script defer src="https://cdn.vercel-analytics.com/v1/script.js"></script>
</head>

<body class="bg-[#0a192f] text-gray-300">

    <!-- Navbar -->
    <nav class="flex justify-between items-center py-6 px-10 bg-[#0a192f] border-b border-gray-700">
        <a href="../../index.html" class="text-teal-400 text-lg font-bold">Kiran</a>
        <div class="space-x-8">
            <a href="password-vault.html" class="hover:text-teal-400">Password Vault</a>
            <a href="secure-notes.html" class="hover:text-teal-400">Secure Notes</a>
            <a href="rbac.html" class="hover:text-teal-400">RBAC</a>
            <a href="audit.html" class="text-teal-400 font-semibold">Audit Logs</a>
            <a href="../../index.html" class="hover:text-teal-400">← Back to Home</a>
        </div>
    </nav>

    <!-- Header -->
    <section class="px-10 py-14 max-w-6xl mx-auto">
        <h1 class="text-4xl font-bold text-gray-100">Audit Logging Dashboard</h1>
        <p class="text-gray-400 mt-4 max-w-3xl">
            This dashboard simulates real audit logs — failed logins, password changes, RBAC modifications,
            suspicious activity, and administrative operations.
            Logs auto-generate every few seconds for demonstration.
        </p>
    </section>

    <!-- Search & Filters -->
    <section class="px-10 max-w-6xl mx-auto">
        <div class="bg-[#112240] p-6 rounded-lg border border-gray-700">
            <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
                
                <!-- Search Bar -->
                <input id="logSearch"
                       type="text"
                       placeholder="Search logs..."
                       class="w-full md:w-1/2 p-3 rounded bg-[#0a192f] border border-gray-600 text-gray-300" />

                <!-- Filter Dropdown -->
                <select id="severityFilter"
                        class="w-full md:w-1/4 p-3 rounded bg-[#0a192f] border border-gray-600 text-gray-300">
                    <option value="all">All Severities</option>
                    <option value="info">INFO</option>
                    <option value="warning">WARNING</option>
                    <option value="critical">CRITICAL</option>
                </select>
            </div>
        </div>
    </section>

    <!-- Logs Table -->
    <section class="px-10 mt-10 max-w-6xl mx-auto mb-20">
        <div class="bg-[#112240] p-6 rounded-lg border border-gray-700">
            <h2 class="text-2xl font-bold text-gray-100 mb-6">System Event Logs</h2>

            <table class="w-full text-left border-collapse">
                <thead>
                    <tr class="text-gray-300 border-b border-gray-700">
                        <th class="py-3">Timestamp</th>
                        <th class="py-3">Severity</th>
                        <th class="py-3">Event</th>
                    </tr>
                </thead>

                <tbody id="logTable" class="text-gray-400"></tbody>
            </table>
        </div>
    </section>

    <!-- JavaScript -->
    <script>
        const logTable = document.getElementById("logTable");
        const searchInput = document.getElementById("logSearch");
        const severityFilter = document.getElementById("severityFilter");

        const severityColors = {
            info: "text-blue-400",
            warning: "text-yellow-400",
            critical: "text-red-400"
        };

        const events = [
            { type: "info", msg: "User logged in successfully" },
            { type: "warning", msg: "Multiple failed login attempts detected" },
            { type: "critical", msg: "Admin account lockout triggered" },
            { type: "info", msg: "Password changed for user account" },
            { type: "warning", msg: "Suspicious IP attempted access" },
            { type: "critical", msg: "Privilege escalation attempt detected" },
            { type: "info", msg: "RBAC role updated by admin" },
            { type: "info", msg: "Session terminated due to inactivity" },
        ];

        let logs = [];

        function generateTimestamp() {
            return new Date().toLocaleString();
        }

        function addLog() {
            const event = events[Math.floor(Math.random() * events.length)];
            const log = {
                timestamp: generateTimestamp(),
                severity: event.type,
                message: event.msg
            };

            logs.unshift(log);
            renderLogs();
        }

        function renderLogs() {
            const search = searchInput.value.toLowerCase();
            const filter = severityFilter.value;

            logTable.innerHTML = "";

            logs
                .filter(log =>
                    (filter === "all" || log.severity === filter) &&
                    (log.message.toLowerCase().includes(search))
                )
                .forEach(log => {
                    const row = `
                        <tr class="border-b border-gray-700">
                            <td class="py-3">${log.timestamp}</td>
                            <td class="py-3 font-semibold ${severityColors[log.severity]}">
                                ${log.severity.toUpperCase()}
                            </td>
                            <td class="py-3">${log.message}</td>
                        </tr>
                    `;
                    logTable.innerHTML += row;
                });
        }

        searchInput.addEventListener("input", renderLogs);
        severityFilter.addEventListener("change", renderLogs);

        // Generate logs automatically every 4 seconds
        setInterval(addLog, 4000);

        // Add initial logs
        for (let i = 0; i < 8; i++) addLog();
    </script>

</body>
</html>
